(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const u of i)if(u.type==="childList")for(const m of u.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function n(i){const u={};return i.integrity&&(u.integrity=i.integrity),i.referrerPolicy&&(u.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?u.credentials="include":i.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(i){if(i.ep)return;i.ep=!0;const u=n(i);fetch(i.href,u)}})();const Te="modulepreload",Oe=function(e){return"/sudoku/"+e},be={},Re=function(t,n,o){let i=Promise.resolve();if(n&&n.length>0){let f=function(r){return Promise.all(r.map(s=>Promise.resolve(s).then(l=>({status:"fulfilled",value:l}),l=>({status:"rejected",reason:l}))))};var m=f;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),c=d?.nonce||d?.getAttribute("nonce");i=f(n.map(r=>{if(r=Oe(r),r in be)return;be[r]=!0;const s=r.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${l}`))return;const a=document.createElement("link");if(a.rel=s?"stylesheet":Te,s||(a.as="script"),a.crossOrigin="",a.href=r,c&&a.setAttribute("nonce",c),document.head.appendChild(a),s)return new Promise((g,p)=>{a.addEventListener("load",g),a.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${r}`)))})}))}function u(d){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=d,window.dispatchEvent(c),!c.defaultPrevented)throw d}return i.then(d=>{for(const c of d||[])c.status==="rejected"&&u(c.reason);return t().catch(u)})};function De(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:i,onRegisteredSW:u,onRegisterError:m}=e;let d,c;const f=async(s=!0)=>{await c};async function r(){if("serviceWorker"in navigator){if(d=await Re(async()=>{const{Workbox:s}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:s}},[]).then(({Workbox:s})=>new s("/sudoku/sw.js",{scope:"/sudoku/",type:"classic"})).catch(s=>{m?.(s)}),!d)return;d.addEventListener("activated",s=>{(s.isUpdate||s.isExternal)&&window.location.reload()}),d.addEventListener("installed",s=>{s.isUpdate||o?.()}),d.register({immediate:t}).then(s=>{u?u("/sudoku/sw.js",s):i?.(s)}).catch(s=>{m?.(s)})}}return c=r(),f}const Z=e=>{for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},Se=511,w=e=>1<<e-1,Ve=e=>e!==0&&(e&e-1)===0,Ke=e=>Math.log2(e)+1,V=e=>{let t=0,n=e;for(;n;)n&=n-1,t+=1;return t},S=[];for(let e=0;e<9;e++){const t=[],n=[];for(let o=0;o<9;o++)t.push(e*9+o),n.push(o*9+e);S.push(t,n)}for(let e=0;e<3;e++)for(let t=0;t<3;t++){const n=[];for(let o=0;o<3;o++)for(let i=0;i<3;i++)n.push((e*3+o)*9+t*3+i);S.push(n)}const $=Array.from({length:81},()=>new Set);for(const e of S)for(const t of e)for(const n of e)t!==n&&$[t].add(n);const ae=(e,t)=>{if(e[t]!==0)return 0;let n=0;for(const o of $[t]){const i=e[o];i&&(n|=w(i))}return Se&~n},ue=e=>{const t=[];for(let n=1;n<=9;n++)e&w(n)&&t.push(n);return t},Ue=e=>{const t=e.slice(),n=()=>{let i=-1,u=null;for(let m=0;m<81;m++)if(t[m]===0){const d=ae(t,m),c=V(d);if(c===0)return{idx:m,cand:[]};if((!u||c<u.count)&&(u={mask:d,count:c},i=m,c===1))break}return{idx:i,cand:u}},o=()=>{const{idx:i,cand:u}=n();if(i===-1)return!0;if(!u||u.count===0)return!1;const m=Z(ue(u.mask));for(const d of m){if(t[i]=d,o())return!0;t[i]=0}return!1};return o()?t:null},je=(e,t=2)=>{const n=e.slice();let o=0;const i=()=>{let m=-1,d=null;for(let c=0;c<81;c++)if(n[c]===0){const f=ae(n,c),r=V(f);if(r===0)return{idx:c,cand:[]};if((!d||r<d.count)&&(d={mask:f,count:r},m=c,r===1))break}return{idx:m,cand:d}},u=()=>{if(o>=t)return;const{idx:m,cand:d}=i();if(m===-1){o++;return}if(!d||d.count===0)return;const c=ue(d.mask);for(const f of c)if(n[m]=f,u(),n[m]=0,o>=t)return};return u(),o},He=e=>{const t=e.slice();let n=0,o=0,i=0;const u=()=>{let c=-1,f=null;for(let r=0;r<81;r++)if(t[r]===0){const s=ae(t,r),l=V(s);if(l===0)return{idx:r,cand:[]};if((!f||l<f.count)&&(f={mask:s,count:l},c=r,l===1))break}return{idx:c,cand:f}},m=c=>{n+=1,c>i&&(i=c);const{idx:f,cand:r}=u();if(f===-1)return!0;if(!r||r.count===0)return!1;const s=ue(r.mask);s.length>1&&(o+=1);for(const l of s){if(t[f]=l,m(c+1))return!0;t[f]=0}return!1};return{solved:m(0),nodes:n,guesses:o,maxDepth:i}},ve=()=>Ue(Array(81).fill(0)),N=e=>e.map(t=>String(t)).join(""),We=e=>{const t=Array(81).fill(0);for(let n=0;n<81;n++){if(e[n]!==0)continue;let o=0;for(const u of $[n]){const m=e[u];m&&(o|=w(m))}const i=Se&~o;t[n]=i}return t},Fe=e=>{const t=e.slice(),n=We(t),o={nakedSingles:0,hiddenSingles:0,lockedElims:0,nakedPairs:0,hiddenPairs:0,nakedTriples:0,hiddenTriples:0},i=(d,c)=>{t[d]=c,n[d]=0;for(const f of $[d])t[f]===0&&(n[f]&=~w(c))};for(;;){let d=!1;for(let f=0;f<81;f++){if(t[f]!==0)continue;const r=n[f];if(r===0)return{solved:!1,score:1/0,stats:o};Ve(r)&&(i(f,Ke(r)),o.nakedSingles+=1,d=!0)}if(d)continue;for(const f of S){for(let r=1;r<=9;r++){const s=w(r);let l=0,a=-1;for(const g of f)if(t[g]===0&&n[g]&s&&(l+=1,a=g,l>1))break;if(l===1){i(a,r),o.hiddenSingles+=1,d=!0;break}}if(d)break}if(d)continue;let c=!1;for(let f=0;f<9;f++){const r=Math.floor(f/3)*3,s=f%3*3,l=[];for(let a=0;a<3;a++)for(let g=0;g<3;g++)l.push((r+a)*9+s+g);for(let a=1;a<=9;a++){const g=w(a),p=l.filter(v=>t[v]===0&&n[v]&g);if(p.length<2)continue;const h=new Set(p.map(v=>Math.floor(v/9)));if(h.size===1){const v=h.values().next().value;for(const b of S[v])!l.includes(b)&&t[b]===0&&n[b]&g&&(n[b]&=~g,c=!0)}const E=new Set(p.map(v=>v%9));if(E.size===1){const v=E.values().next().value;for(const b of S[9+v])!l.includes(b)&&t[b]===0&&n[b]&g&&(n[b]&=~g,c=!0)}}}for(let f=0;f<9;f++){const r=S[f];for(let s=1;s<=9;s++){const l=w(s),a=r.filter(p=>t[p]===0&&n[p]&l);if(a.length<2)continue;const g=new Set(a.map(p=>Math.floor(p/27)*3+Math.floor(p%9/3)));if(g.size===1){const p=g.values().next().value,h=Math.floor(p/3)*3,E=p%3*3;for(let v=0;v<3;v++)for(let b=0;b<3;b++){const k=(h+v)*9+E+b;!r.includes(k)&&t[k]===0&&n[k]&l&&(n[k]&=~l,c=!0)}}}}for(let f=0;f<9;f++){const r=S[9+f];for(let s=1;s<=9;s++){const l=w(s),a=r.filter(p=>t[p]===0&&n[p]&l);if(a.length<2)continue;const g=new Set(a.map(p=>Math.floor(p/27)*3+Math.floor(p%9/3)));if(g.size===1){const p=g.values().next().value,h=Math.floor(p/3)*3,E=p%3*3;for(let v=0;v<3;v++)for(let b=0;b<3;b++){const k=(h+v)*9+E+b;!r.includes(k)&&t[k]===0&&n[k]&l&&(n[k]&=~l,c=!0)}}}}if(c){o.lockedElims+=1;continue}c=!1;for(const f of S){const r=new Map;for(const s of f){if(t[s]!==0)continue;const l=n[s];if(l===0)return{solved:!1,score:1/0,stats:o};if(V(l)===2){const a=r.get(l)||[];a.push(s),r.set(l,a)}}for(const[s,l]of r.entries())if(l.length===2)for(const a of f)t[a]!==0||l.includes(a)||n[a]&s&&(n[a]&=~s,c=!0)}if(c){o.nakedPairs+=1;continue}c=!1;for(const f of S){const r=Array.from({length:10},()=>[]);for(const s of f){if(t[s]!==0)continue;const l=n[s];for(let a=1;a<=9;a++)l&w(a)&&r[a].push(s)}for(let s=1;s<=8;s++)if(r[s].length===2)for(let l=s+1;l<=9;l++){if(r[l].length!==2)continue;const a=r[s],g=r[l];if(a[0]!==g[0]||a[1]!==g[1])continue;const p=w(s)|w(l);for(const h of a){const E=n[h]&p;E!==n[h]&&(n[h]=E,c=!0)}}}if(c){o.hiddenPairs+=1;continue}c=!1;for(const f of S){const r=[];for(const s of f){if(t[s]!==0)continue;const l=n[s],a=V(l);a>=2&&a<=3&&r.push({idx:s,mask:l})}for(let s=0;s<r.length-2;s++)for(let l=s+1;l<r.length-1;l++)for(let a=l+1;a<r.length;a++){const g=r[s].mask|r[l].mask|r[a].mask;if(V(g)===3)for(const p of f)t[p]===0&&(p===r[s].idx||p===r[l].idx||p===r[a].idx||n[p]&g&&(n[p]&=~g,c=!0))}}if(c){o.nakedTriples+=1;continue}c=!1;for(const f of S){const r=Array.from({length:10},()=>[]);for(const s of f){if(t[s]!==0)continue;const l=n[s];for(let a=1;a<=9;a++)l&w(a)&&r[a].push(s)}for(let s=1;s<=7;s++)if(r[s].length!==0){for(let l=s+1;l<=8;l++)if(r[l].length!==0)for(let a=l+1;a<=9;a++){if(r[a].length===0)continue;const g=new Set([...r[s],...r[l],...r[a]]);if(g.size!==3)continue;const p=w(s)|w(l)|w(a);for(const h of g){if(t[h]!==0)continue;const E=n[h]&p;E!==n[h]&&(n[h]=E,c=!0)}}}}if(c){o.hiddenTriples+=1;continue}break}const u=t.every(d=>d!==0),m=o.nakedSingles*1+o.hiddenSingles*2+o.lockedElims*2+o.nakedPairs*6+o.hiddenPairs*7+o.nakedTriples*8+o.hiddenTriples*9;return{solved:u,score:m,stats:o}},Ge=({scoreMin:e=0,scoreMax:t=1/0,searchMin:n=0,searchMax:o=1/0,ratingMode:i="human",symmetric:u=!0,maxAttempts:m=50}={})=>{const d=i==="tiered";let c=null,f=null,r=null,s=null;const l=Number.isFinite(m);for(let g=0;g<m;g++){const p=ve();if(!p)throw new Error("Failed to generate solution");const h=p.slice(),E=Array.from({length:81},(_,C)=>C);Z(E);let v=81;const b=new Set,k=[];for(const _ of E){if(b.has(_))continue;if(!u){b.add(_),k.push([_]);continue}const C=80-_;b.add(_),b.add(C),k.push(_===C?[_]:[_,C])}Z(k);for(const _ of k){const C=_.filter(y=>h[y]!==0).length;if(C===0)continue;const Y=_.map(y=>h[y]);for(const y of _)h[y]=0;if(je(h,2)!==1){for(let y=0;y<_.length;y++)h[_[y]]=Y[y];continue}v-=C;const A=Fe(h);if(A.solved){if(A.score>=e&&A.score<=t&&(!c||A.score>c.score||A.score===c.score&&v<c.clues)&&(c={score:A.score,clues:v,givens:N(h),solution:N(p)},!l&&!d))return{givens:c.givens,solution:c.solution};const y=A.score<e?e-A.score:A.score-t;(!f||y<f.diff)&&(f={diff:y,givens:N(h),solution:N(p)})}else if(d){const y=He(h);if(!y.solved)continue;const z=y.nodes;z>=n&&z<=o&&(!r||z>r.score||z===r.score&&v<r.clues)&&(r={score:z,clues:v,givens:N(h),solution:N(p)});const he=z<n?n-z:z-o;(!s||he<s.diff)&&(s={diff:he,givens:N(h),solution:N(p)})}}}if(d){if(r)return{givens:r.givens,solution:r.solution};if(c)return{givens:c.givens,solution:c.solution};if(s)return{givens:s.givens,solution:s.solution};if(f)return{givens:f.givens,solution:f.solution}}if(c)return{givens:c.givens,solution:c.solution};if(f)return{givens:f.givens,solution:f.solution};const a=ve();return{givens:N(a),solution:N(a)}},fe="sudoku_v1",J=document.getElementById("board"),ye=document.getElementById("pad"),$e=document.getElementById("padContainer"),Q=document.getElementById("boardWrap"),de=document.getElementById("newPuzzle"),me=document.getElementById("resetPuzzle"),Ce=document.getElementById("themeToggle"),O=document.getElementById("difficultyBubble"),R=document.getElementById("resetBubble"),qe=document.getElementById("loadingOverlay"),q=Array.from(document.querySelectorAll("[data-difficulty]")),Ye=Array.from(document.querySelectorAll("[data-reset]")),ee=document.getElementById("noteSwitch"),Je=document.getElementById("eraseBtn"),te=document.getElementById("undoBtn"),ne=document.getElementById("redoBtn"),ke=document.querySelectorAll("meta[name='theme-color']");let B=null,L=null,x=0,M=!1,oe="light",se=null,re=null,P=[],T=[],W="easy";const D={cells:[],padButtons:new Map},Qe=500,G={easy:{scoreMin:40,scoreMax:50,maxAttempts:10,ratingMode:"human"},medium:{scoreMin:65,scoreMax:75,maxAttempts:10,ratingMode:"human"},hard:{scoreMin:100,scoreMax:250,searchMin:2e3,searchMax:6e3,maxAttempts:100,ratingMode:"tiered"}},Xe=(e,t)=>e*9+t,Me=e=>[Math.floor(e/9),e%9],ie=e=>1<<e-1,H=(e,t,n)=>Math.max(t,Math.min(n,e));function pe(e){if(oe=e==="dark"?"dark":"light",document.documentElement.setAttribute("data-theme",oe),ke.length){const t=getComputedStyle(document.documentElement).getPropertyValue("--panel").trim();t&&ke.forEach(n=>n.setAttribute("content",t))}}function Ne(){return se?.matches?"dark":(re?.matches,"light")}function Ee(){pe(Ne())}function Ze(){if(!window.matchMedia)return;se=window.matchMedia("(prefers-color-scheme: dark)"),re=window.matchMedia("(prefers-color-scheme: light)");const e=t=>{t&&(t.addEventListener?t.addEventListener("change",Ee):t.addListener&&t.addListener(Ee))};e(se),e(re)}function le(e){const t=G[e]?e:"easy";W=t,q.forEach(n=>{n.classList.toggle("menu__option--active",n.dataset.difficulty===t)})}function et(){const t=q.find(o=>o.classList.contains("menu__option--active"))?.dataset.difficulty;return{...G[t]||G.easy,symmetric:Math.random()<.33}}function K(e){M=!!e,ee.classList.toggle("pad__toggle--active",M),ee.setAttribute("aria-checked",M?"true":"false"),$e?.classList.toggle("pad--notes-mode",M),I()}function U(e){const t=!!e;O?.classList.toggle("menu__bubble--open",t),O?.setAttribute("aria-hidden",t?"false":"true"),de?.setAttribute("aria-expanded",t?"true":"false")}function j(e){const t=!!e;R?.classList.toggle("menu__bubble--open",t),R?.setAttribute("aria-hidden",t?"false":"true"),me?.setAttribute("aria-expanded",t?"true":"false")}function _e(e){const t=!!e;document.body.classList.toggle("app--loading",t),qe?.setAttribute("aria-hidden",t?"false":"true"),de.disabled=t,me.disabled=t,Ce.disabled=t,q.forEach(n=>{n.disabled=t})}function tt(){return new Promise(e=>{requestAnimationFrame(()=>setTimeout(e,0))})}function nt(e){return{entries:e.entries.map(String).join(""),notes:e.notes.slice()}}function F(){const e={puzzle:B,progress:nt(L),history:P,redoHistory:T};localStorage.setItem(fe,JSON.stringify(e))}function ot(){const e=localStorage.getItem(fe);if(!e)return!1;try{const t=JSON.parse(e);if(!t?.puzzle?.givens||!t?.puzzle?.solution||!t?.progress)return!1;const n=st(t.progress);return n?(B=t.puzzle,W=it(B.difficulty),L=n,P=Array.isArray(t.history)?t.history.map(xe).filter(Boolean):[],T=Array.isArray(t.redoHistory)?t.redoHistory.map(xe).filter(Boolean):[],!0):!1}catch{return!1}}function st(e){const t=rt(e.entries),n=Array.isArray(e.notes)?e.notes.map(o=>Number(o)||0):null;return!t||!n||n.length!==81?null:{entries:t,notes:n}}function rt(e){return e?Array.isArray(e)?e.length!==81?null:e.map(t=>H(Number(t)||0,0,9)):typeof e=="string"&&e.length===81?e.split("").map(t=>H(Number(t)||0,0,9)):null:null}function it(e){return G[e]?e:"easy"}function xe(e){if(!e||!Number.isInteger(e.idx)||e.idx<0||e.idx>=81)return null;const t=H(Number(e.prevEntry)||0,0,9),n=H(Number(e.nextEntry)||0,0,9),o=Number(e.prevNotes),i=Number(e.nextNotes);return!Number.isInteger(o)||!Number.isInteger(i)?null:{idx:e.idx,prevEntry:t,nextEntry:n,prevNotes:o,nextNotes:i}}function lt(){J.innerHTML="",D.cells=[];for(let e=0;e<9;e++)for(let t=0;t<9;t++){const n=Xe(e,t),o=document.createElement("div");o.className="board__cell",o.dataset.idx=String(n),o.dataset.r=String(e),o.dataset.c=String(t);const i=document.createElement("div");i.className="board__value";const u=document.createElement("div");u.className="board__notes";for(let m=1;m<=9;m++){const d=document.createElement("div");d.className="board__note",d.dataset.n=String(m),d.textContent=String(m),u.appendChild(d)}o.appendChild(i),o.appendChild(u),J.appendChild(o),D.cells.push({idx:n,r:e,c:t,root:o,valueEl:i,noteEls:Array.from(u.querySelectorAll(".board__note"))})}ye.innerHTML="",D.padButtons.clear();for(let e=1;e<=9;e++){const t=document.createElement("button");t.type="button",t.className="btn btn--pad pad__button",t.dataset.n=String(e),t.textContent=String(e),t.addEventListener("click",()=>Le(e)),ye.appendChild(t),D.padButtons.set(e,t)}J.addEventListener("pointerdown",e=>{const t=e.target.closest(".board__cell");if(!t)return;const n=Number(t.dataset.idx);if(n===x){K(!M);return}Ie(n)}),ee.addEventListener("click",()=>K(!M)),Je.addEventListener("click",()=>we()),te.addEventListener("click",()=>Ae()),ne?.addEventListener("click",()=>X()),de.addEventListener("click",e=>{e.stopPropagation(),j(!1);const t=O?.classList.contains("menu__bubble--open");U(!t)}),me?.addEventListener("click",e=>{e.stopPropagation(),U(!1);const t=R?.classList.contains("menu__bubble--open");j(!t)}),Ce?.addEventListener("click",()=>{pe(oe==="dark"?"light":"dark")}),q.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const n=e.dataset.difficulty;le(n),localStorage.removeItem(fe),ze(),U(!1)})}),O?.addEventListener("click",e=>{e.stopPropagation()}),R?.addEventListener("click",e=>{e.stopPropagation()}),Ye.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation(),j(!1),gt()})}),window.addEventListener("keydown",e=>{if(["INPUT","TEXTAREA","SELECT"].includes(document.activeElement?.tagName))return;const t=e.key,n=navigator.userAgentData?navigator.userAgentData.platform==="macOS":/Mac|iPhone|iPad|iPod/.test(navigator.userAgent),o=t==="z"||t==="Z",i=t==="y"||t==="Y";if(o&&!e.altKey&&(n?e.metaKey:e.ctrlKey)){e.preventDefault(),e.shiftKey?X():Ae();return}if(i&&!e.altKey&&!e.shiftKey&&!n&&e.ctrlKey){e.preventDefault(),X();return}if(!(e.metaKey||e.ctrlKey||e.altKey)){if(t>="1"&&t<="9"){e.preventDefault(),Le(Number(t));return}if(t==="Backspace"||t==="Delete"){e.preventDefault(),we();return}if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t)){e.preventDefault(),mt(t);return}if(e.code==="Space"){e.preventDefault(),K(!M);return}}}),document.addEventListener("click",()=>{O?.classList.contains("menu__bubble--open")&&U(!1),R?.classList.contains("menu__bubble--open")&&j(!1)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&(O?.classList.contains("menu__bubble--open")&&U(!1),R?.classList.contains("menu__bubble--open")&&j(!1))})}function ct(e){return Number(B.givens[e])||L.entries[e]||0}function Pe(e){return Number(B.givens[e])!==0}function Be(){const e=Array(81).fill(0);for(let t=0;t<81;t++)e[t]=Number(B.givens[t])||L.entries[t]||0;return e}function at(e){const t=Array.from({length:81},()=>!1);function n(o){const i=new Map;for(const u of o){const m=e[u];m&&(i.has(m)||i.set(m,[]),i.get(m).push(u))}for(const u of i.values())if(u.length>=2)for(const m of u)t[m]=!0}for(let o=0;o<9;o++)n(Array.from({length:9},(i,u)=>o*9+u));for(let o=0;o<9;o++)n(Array.from({length:9},(i,u)=>u*9+o));for(let o=0;o<3;o++)for(let i=0;i<3;i++){const u=[];for(let m=o*3;m<o*3+3;m++)for(let d=i*3;d<i*3+3;d++)u.push(m*9+d);n(u)}return t}function ut(e){const t=Array.from({length:9},()=>new Set),n=Array.from({length:9},()=>new Set),o=Array.from({length:9},()=>new Set);for(let i=0;i<81;i++){const u=e[i];if(!u)continue;const[m,d]=Me(i);t[m].add(u),n[d].add(u);const c=Math.floor(m/3)*3+Math.floor(d/3);o[c].add(u)}return{rowValues:t,colValues:n,boxValues:o}}function ft(){for(let e=0;e<81;e++){const t=Number(B.givens[e])||L.entries[e]||0;if(t===0||t!==Number(B.solution[e]))return!1}return!0}function dt(e){const t=Be();let n=0;for(const o of t)o===e&&(n+=1);return n>=9}function I(){const e=B.givens,t=L.entries,n=L.notes,o=ct(x),i=Be(),u=Array(10).fill(0);i.forEach(r=>{r&&(u[r]+=1)});const m=at(i),{rowValues:d,colValues:c,boxValues:f}=ut(i);if(Q?.classList.toggle("board-shell--completed",ft()),Q){const r=`COMPLETED â€¢ ${W.toUpperCase()}`;Q.setAttribute("data-completed-label",r)}D.cells.forEach(r=>{const{idx:s,root:l,valueEl:a,noteEls:g,r:p,c:h}=r;l.classList.remove("board__cell--selected","board__cell--highlight","board__cell--error","board__cell--has-value","board__cell--notes-active"),a.classList.remove("board__value--given","board__value--entry"),a.textContent="",g.forEach(k=>{k.classList.remove("board__note--filled","board__note--conflict")});const E=Number(e[s]),v=t[s],b=E||v||0;if(b)l.classList.add("board__cell--has-value"),a.textContent=String(b),a.classList.add(E?"board__value--given":"board__value--entry");else{const k=n[s]|0;if(k){const _=p,C=h,Y=Math.floor(_/3)*3+Math.floor(C/3);g.forEach(A=>{const y=Number(A.dataset.n);k&ie(y)&&(A.classList.add("board__note--filled"),(d[_].has(y)||c[C].has(y)||f[Y].has(y))&&A.classList.add("board__note--conflict"))})}}!b&&M&&s===x&&l.classList.add("board__cell--notes-active"),s===x&&l.classList.add("board__cell--selected"),o!==0&&b===o&&l.classList.add("board__cell--highlight"),m[s]&&l.classList.add("board__cell--error")}),D.padButtons.forEach((r,s)=>{const l=u[s]>=9;r.disabled=!M&&l}),pt()}function Ie(e){x=H(e,0,80),I()}function mt(e){const[t,n]=Me(x);let o=t,i=n;e==="ArrowUp"&&(o=(t+8)%9),e==="ArrowDown"&&(o=(t+1)%9),e==="ArrowLeft"&&(i=(n+8)%9),e==="ArrowRight"&&(i=(n+1)%9),x=o*9+i,I()}function Le(e){if(Pe(x)||!M&&dt(e))return;const t=L.notes[x]|0;if(M){const u=L.entries[x]!==0?t|ie(e):t^ie(e);ce(x,0,u);return}ce(x,e,t)}function we(){if(Pe(x))return;const t=L.entries[x]!==0?L.notes[x]|0:0;ce(x,0,t)}function ce(e,t,n){const o=L.entries[e],i=L.notes[e]|0;o===t&&i===n||(ge(e,t,n),P.push({idx:e,prevEntry:o,prevNotes:i,nextEntry:t,nextNotes:n}),T=[],P.length>Qe&&P.shift(),F(),I())}function ge(e,t,n){L.entries[e]=t,L.notes[e]=n}function Ae(){const e=P.pop();e&&(ge(e.idx,e.prevEntry,e.prevNotes),T.push(e),F(),I())}function X(){const e=T.pop();e&&(ge(e.idx,e.nextEntry,e.nextNotes),P.push(e),F(),I())}function pt(){te&&(te.disabled=P.length===0),ne&&(ne.disabled=T.length===0)}async function ze(){_e(!0),await tt();try{B={...Ge(et()),difficulty:W},L={entries:Array(81).fill(0),notes:Array(81).fill(0)},x=0,P=[],T=[],K(!1),F(),I()}finally{_e(!1)}}function gt(){L={entries:Array(81).fill(0),notes:Array(81).fill(0)},P=[],T=[],x=0,K(!1),F(),I()}function ht(){De({immediate:!0}),Ze(),pe(Ne()),lt(),le("easy"),ot()?(le(W),K(!1),I()):ze(),Ie(0)}ht();

(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const Le="modulepreload",Ae=function(e){return"/sudoku/"+e},re={},we=function(t,r,o){let n=Promise.resolve();if(r&&r.length>0){let d=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};var i=d;document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),a=l?.nonce||l?.getAttribute("nonce");n=d(r.map(u=>{if(u=Ae(u),u in re)return;re[u]=!0;const c=u.endsWith(".css"),g=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${g}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":Le,c||(f.as="script"),f.crossOrigin="",f.href=u,a&&f.setAttribute("nonce",a),document.head.appendChild(f),c)return new Promise((M,z)=>{f.addEventListener("load",M),f.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(l){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=l,window.dispatchEvent(a),!a.defaultPrevented)throw l}return n.then(l=>{for(const a of l||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})};function ke(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:o,onRegistered:n,onRegisteredSW:s,onRegisterError:i}=e;let l,a;const d=async(c=!0)=>{await a};async function u(){if("serviceWorker"in navigator){if(l=await we(async()=>{const{Workbox:c}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:c}},[]).then(({Workbox:c})=>new c("/sudoku/sw.js",{scope:"/sudoku/",type:"classic"})).catch(c=>{i?.(c)}),!l)return;l.addEventListener("activated",c=>{(c.isUpdate||c.isExternal)&&window.location.reload()}),l.addEventListener("installed",c=>{c.isUpdate||o?.()}),l.register({immediate:t}).then(c=>{s?s("/sudoku/sw.js",c):n?.(c)}).catch(c=>{i?.(c)})}}return a=u(),d}const V=e=>{for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e},fe=(e,t)=>{if(e[t]!==0)return[];const r=Math.floor(t/9),o=t%9,n=new Set;for(let a=0;a<9;a++)n.add(e[r*9+a]),n.add(e[a*9+o]);const s=Math.floor(r/3)*3,i=Math.floor(o/3)*3;for(let a=s;a<s+3;a++)for(let d=i;d<i+3;d++)n.add(e[a*9+d]);const l=[];for(let a=1;a<=9;a++)n.has(a)||l.push(a);return l},Ne=e=>{const t=e.slice(),r=()=>{let n=-1,s=null;for(let i=0;i<81;i++)if(t[i]===0){const l=fe(t,i);if(l.length===0)return{idx:i,cand:[]};if((!s||l.length<s.length)&&(s=l,n=i,l.length===1))break}return{idx:n,cand:s}},o=()=>{const{idx:n,cand:s}=r();if(n===-1)return!0;if(s.length===0)return!1;V(s);for(const i of s){if(t[n]=i,o())return!0;t[n]=0}return!1};return o()?t:null},Se=(e,t=2)=>{const r=e.slice();let o=0;const n=()=>{let i=-1,l=null;for(let a=0;a<81;a++)if(r[a]===0){const d=fe(r,a);if(d.length===0)return{idx:a,cand:[]};if((!l||d.length<l.length)&&(l=d,i=a,d.length===1))break}return{idx:i,cand:l}},s=()=>{if(o>=t)return;const{idx:i,cand:l}=n();if(i===-1){o++;return}if(l.length!==0){for(const a of l)if(r[i]=a,s(),r[i]=0,o>=t)return}};return s(),o},xe=()=>Ne(Array(81).fill(0)),oe=e=>e.map(t=>String(t)).join(""),Ce=({minClues:e=32,maxClues:t=36,symmetric:r=!0}={})=>{const o=xe();if(!o)throw new Error("Failed to generate solution");const n=o.slice(),s=Array.from({length:81},(u,c)=>c);V(s);const i=e+Math.floor(Math.random()*(t-e+1));let l=81;const a=new Set,d=[];for(const u of s){if(a.has(u))continue;if(!r){a.add(u),d.push([u]);continue}const c=80-u;a.add(u),a.add(c),d.push(u===c?[u]:[u,c])}V(d);for(const u of d){if(l<=i)break;const c=u.filter(f=>n[f]!==0).length;if(c===0||l-c<i)continue;const g=u.map(f=>n[f]);for(const f of u)n[f]=0;if(Se(n,2)!==1)for(let f=0;f<u.length;f++)n[u[f]]=g[f];else l-=c}return{givens:oe(n),solution:oe(o)}},J="sudoku_v1",T=document.getElementById("board"),se=document.getElementById("pad"),Be=document.getElementById("padContainer"),D=document.getElementById("boardWrap"),me=document.getElementById("newPuzzle"),pe=document.getElementById("resetPuzzle"),Pe=document.getElementById("themeToggle"),E=document.getElementById("difficultyBubble"),L=document.getElementById("resetBubble"),Q=Array.from(document.querySelectorAll("[data-difficulty]")),Ie=Array.from(document.querySelectorAll("[data-reset]")),K=document.getElementById("noteSwitch"),Me=document.getElementById("eraseBtn"),U=document.getElementById("undoBtn"),j=document.getElementById("redoBtn"),ie=document.querySelector("meta[name='theme-color']");let b=null,p=null,m=0,y=!1,W="light",H=null,G=null,h=[],_=[],S="easy";const $={cells:[]},ze=500,I={easy:{minClues:35,maxClues:40},medium:{minClues:30,maxClues:35},hard:{minClues:25,maxClues:30}},Oe=(e,t)=>e*9+t,ge=e=>[Math.floor(e/9),e%9],q=e=>1<<e-1,N=(e,t,r)=>Math.max(t,Math.min(r,e));function X(e){if(W=e==="dark"?"dark":"light",document.documentElement.setAttribute("data-theme",W),ie){const t=getComputedStyle(document.documentElement).getPropertyValue("--panel").trim();t&&ie.setAttribute("content",t)}}function he(){return H?.matches?"dark":(G?.matches,"light")}function le(){X(he())}function Te(){if(!window.matchMedia)return;H=window.matchMedia("(prefers-color-scheme: dark)"),G=window.matchMedia("(prefers-color-scheme: light)");const e=t=>{t&&(t.addEventListener?t.addEventListener("change",le):t.addListener&&t.addListener(le))};e(H),e(G)}function F(e){const t=I[e]?e:"easy";S=t,Q.forEach(r=>{r.classList.toggle("menu__option--active",r.dataset.difficulty===t)})}function De(){const t=Q.find(o=>o.classList.contains("menu__option--active"))?.dataset.difficulty;return{...I[t]||I.easy,symmetric:Math.random()<.33}}function A(e){y=!!e,K.classList.toggle("pad__toggle--active",y),K.setAttribute("aria-checked",y?"true":"false"),Be?.classList.toggle("pad--notes-mode",y),v()}function w(e){const t=!!e;E?.classList.toggle("menu__bubble--open",t),E?.setAttribute("aria-hidden",t?"false":"true"),me?.setAttribute("aria-expanded",t?"true":"false")}function k(e){const t=!!e;L?.classList.toggle("menu__bubble--open",t),L?.setAttribute("aria-hidden",t?"false":"true"),pe?.setAttribute("aria-expanded",t?"true":"false")}function Re(e){return{entries:e.entries.map(String).join(""),notes:e.notes.slice()}}function x(){const e={puzzle:b,progress:Re(p),history:h,redoHistory:_};localStorage.setItem(J,JSON.stringify(e))}function Ve(){const e=localStorage.getItem(J);if(!e)return!1;try{const t=JSON.parse(e);if(!t?.puzzle?.givens||!t?.puzzle?.solution||!t?.progress)return!1;const r=Ke(t.progress);return r?(b=t.puzzle,S=je(b.difficulty),p=r,h=Array.isArray(t.history)?t.history.map(ae).filter(Boolean):[],_=Array.isArray(t.redoHistory)?t.redoHistory.map(ae).filter(Boolean):[],!0):!1}catch{return!1}}function Ke(e){const t=Ue(e.entries),r=Array.isArray(e.notes)?e.notes.map(o=>Number(o)||0):null;return!t||!r||r.length!==81?null:{entries:t,notes:r}}function Ue(e){return e?Array.isArray(e)?e.length!==81?null:e.map(t=>N(Number(t)||0,0,9)):typeof e=="string"&&e.length===81?e.split("").map(t=>N(Number(t)||0,0,9)):null:null}function je(e){return I[e]?e:"easy"}function ae(e){if(!e||!Number.isInteger(e.idx)||e.idx<0||e.idx>=81)return null;const t=N(Number(e.prevEntry)||0,0,9),r=N(Number(e.nextEntry)||0,0,9),o=Number(e.prevNotes),n=Number(e.nextNotes);return!Number.isInteger(o)||!Number.isInteger(n)?null:{idx:e.idx,prevEntry:t,nextEntry:r,prevNotes:o,nextNotes:n}}function We(){T.innerHTML="",$.cells=[];for(let e=0;e<9;e++)for(let t=0;t<9;t++){const r=Oe(e,t),o=document.createElement("div");o.className="board__cell",o.dataset.idx=String(r),o.dataset.r=String(e),o.dataset.c=String(t);const n=document.createElement("div");n.className="board__value";const s=document.createElement("div");s.className="board__notes";for(let i=1;i<=9;i++){const l=document.createElement("div");l.className="board__note",l.dataset.n=String(i),l.textContent=String(i),s.appendChild(l)}o.appendChild(n),o.appendChild(s),T.appendChild(o),$.cells.push({idx:r,r:e,c:t,root:o,valueEl:n,noteEls:Array.from(s.querySelectorAll(".board__note"))})}se.innerHTML="";for(let e=1;e<=9;e++){const t=document.createElement("button");t.type="button",t.className="btn btn--pad pad__button",t.dataset.n=String(e),t.textContent=String(e),t.addEventListener("click",()=>ce(e)),se.appendChild(t)}T.addEventListener("click",e=>{const t=e.target.closest(".board__cell");if(!t)return;const r=Number(t.dataset.idx);if(r===m){A(!y);return}ye(r)}),K.addEventListener("click",()=>A(!y)),Me.addEventListener("click",()=>ue()),U.addEventListener("click",()=>de()),j?.addEventListener("click",()=>R()),me.addEventListener("click",e=>{e.stopPropagation(),k(!1);const t=E?.classList.contains("menu__bubble--open");w(!t)}),pe?.addEventListener("click",e=>{e.stopPropagation(),w(!1);const t=L?.classList.contains("menu__bubble--open");k(!t)}),Pe?.addEventListener("click",()=>{X(W==="dark"?"light":"dark")}),Q.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const r=e.dataset.difficulty;F(r),localStorage.removeItem(J),ve(),w(!1)})}),E?.addEventListener("click",e=>{e.stopPropagation()}),L?.addEventListener("click",e=>{e.stopPropagation()}),Ie.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation(),k(!1),Qe()})}),window.addEventListener("keydown",e=>{if(["INPUT","TEXTAREA","SELECT"].includes(document.activeElement?.tagName))return;const t=e.key,r=navigator.userAgentData?navigator.userAgentData.platform==="macOS":/Mac|iPhone|iPad|iPod/.test(navigator.userAgent),o=t==="z"||t==="Z",n=t==="y"||t==="Y";if(o&&!e.altKey&&(r?e.metaKey:e.ctrlKey)){e.preventDefault(),e.shiftKey?R():de();return}if(n&&!e.altKey&&!e.shiftKey&&!r&&e.ctrlKey){e.preventDefault(),R();return}if(!(e.metaKey||e.ctrlKey||e.altKey)){if(t>="1"&&t<="9"){e.preventDefault(),ce(Number(t));return}if(t==="Backspace"||t==="Delete"){e.preventDefault(),ue();return}if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t)){e.preventDefault(),Ye(t);return}if(e.code==="Space"){e.preventDefault(),A(!y);return}}}),document.addEventListener("click",()=>{E?.classList.contains("menu__bubble--open")&&w(!1),L?.classList.contains("menu__bubble--open")&&k(!1)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&(E?.classList.contains("menu__bubble--open")&&w(!1),L?.classList.contains("menu__bubble--open")&&k(!1))})}function He(e){return Number(b.givens[e])||p.entries[e]||0}function be(e){return Number(b.givens[e])!==0}function Ge(){const e=Array(81).fill(0);for(let t=0;t<81;t++)e[t]=Number(b.givens[t])||p.entries[t]||0;return e}function $e(e){const t=Array.from({length:81},()=>!1);function r(o){const n=new Map;for(const s of o){const i=e[s];i&&(n.has(i)||n.set(i,[]),n.get(i).push(s))}for(const s of n.values())if(s.length>=2)for(const i of s)t[i]=!0}for(let o=0;o<9;o++)r(Array.from({length:9},(n,s)=>o*9+s));for(let o=0;o<9;o++)r(Array.from({length:9},(n,s)=>s*9+o));for(let o=0;o<3;o++)for(let n=0;n<3;n++){const s=[];for(let i=o*3;i<o*3+3;i++)for(let l=n*3;l<n*3+3;l++)s.push(i*9+l);r(s)}return t}function qe(e){const t=Array.from({length:9},()=>new Set),r=Array.from({length:9},()=>new Set),o=Array.from({length:9},()=>new Set);for(let n=0;n<81;n++){const s=e[n];if(!s)continue;const[i,l]=ge(n);t[i].add(s),r[l].add(s);const a=Math.floor(i/3)*3+Math.floor(l/3);o[a].add(s)}return{rowValues:t,colValues:r,boxValues:o}}function Fe(){for(let e=0;e<81;e++){const t=Number(b.givens[e])||p.entries[e]||0;if(t===0||t!==Number(b.solution[e]))return!1}return!0}function v(){const e=b.givens,t=p.entries,r=p.notes,o=He(m),n=Ge(),s=$e(n),{rowValues:i,colValues:l,boxValues:a}=qe(n);if(D?.classList.toggle("board-shell--completed",Fe()),D){const d=`COMPLETED â€¢ ${S.toUpperCase()}`;D.setAttribute("data-completed-label",d)}$.cells.forEach(d=>{const{idx:u,root:c,valueEl:g,noteEls:f,r:M,c:z}=d;c.classList.remove("board__cell--selected","board__cell--highlight","board__cell--error","board__cell--has-value","board__cell--notes-active"),g.classList.remove("board__value--given","board__value--entry"),g.textContent="",f.forEach(B=>{B.classList.remove("board__note--filled","board__note--conflict")});const ee=Number(e[u]),_e=t[u],C=ee||_e||0;if(C)c.classList.add("board__cell--has-value"),g.textContent=String(C),g.classList.add(ee?"board__value--given":"board__value--entry");else{const B=r[u]|0;if(B){const te=M,ne=z,Ee=Math.floor(te/3)*3+Math.floor(ne/3);f.forEach(O=>{const P=Number(O.dataset.n);B&q(P)&&(O.classList.add("board__note--filled"),(i[te].has(P)||l[ne].has(P)||a[Ee].has(P))&&O.classList.add("board__note--conflict"))})}}!C&&y&&u===m&&c.classList.add("board__cell--notes-active"),u===m&&c.classList.add("board__cell--selected"),o!==0&&C===o&&c.classList.add("board__cell--highlight"),s[u]&&c.classList.add("board__cell--error")}),Je()}function ye(e){m=N(e,0,80),v()}function Ye(e){const[t,r]=ge(m);let o=t,n=r;e==="ArrowUp"&&(o=(t+8)%9),e==="ArrowDown"&&(o=(t+1)%9),e==="ArrowLeft"&&(n=(r+8)%9),e==="ArrowRight"&&(n=(r+1)%9),m=o*9+n,v()}function ce(e){if(be(m))return;const t=p.notes[m]|0;if(y){const s=p.entries[m]!==0?t|q(e):t^q(e);Y(m,0,s);return}Y(m,e,t)}function ue(){if(be(m))return;const t=p.entries[m]!==0?p.notes[m]|0:0;Y(m,0,t)}function Y(e,t,r){const o=p.entries[e],n=p.notes[e]|0;o===t&&n===r||(Z(e,t,r),h.push({idx:e,prevEntry:o,prevNotes:n,nextEntry:t,nextNotes:r}),_=[],h.length>ze&&h.shift(),x(),v())}function Z(e,t,r){p.entries[e]=t,p.notes[e]=r}function de(){const e=h.pop();e&&(Z(e.idx,e.prevEntry,e.prevNotes),_.push(e),x(),v())}function R(){const e=_.pop();e&&(Z(e.idx,e.nextEntry,e.nextNotes),h.push(e),x(),v())}function Je(){U&&(U.disabled=h.length===0),j&&(j.disabled=_.length===0)}function ve(){b={...Ce(De()),difficulty:S},p={entries:Array(81).fill(0),notes:Array(81).fill(0)},m=0,h=[],_=[],A(!1),x(),v()}function Qe(){p={entries:Array(81).fill(0),notes:Array(81).fill(0)},h=[],_=[],m=0,A(!1),x(),v()}function Xe(){ke({immediate:!0}),Te(),X(he()),We(),F("easy"),Ve()?(F(S),A(!1),v()):ve(),ye(0)}Xe();

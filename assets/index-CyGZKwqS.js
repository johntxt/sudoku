(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const we="modulepreload",Ne=function(e){return"/sudoku/"+e},re={},ke=function(t,r,o){let n=Promise.resolve();if(r&&r.length>0){let f=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};var i=f;document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),a=l?.nonce||l?.getAttribute("nonce");n=f(r.map(u=>{if(u=Ne(u),u in re)return;re[u]=!0;const c=u.endsWith(".css"),g=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${g}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":we,c||(d.as="script"),d.crossOrigin="",d.href=u,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((B,O)=>{d.addEventListener("load",B),d.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(l){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=l,window.dispatchEvent(a),!a.defaultPrevented)throw l}return n.then(l=>{for(const a of l||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})};function Se(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:o,onRegistered:n,onRegisteredSW:s,onRegisterError:i}=e;let l,a;const f=async(c=!0)=>{await a};async function u(){if("serviceWorker"in navigator){if(l=await ke(async()=>{const{Workbox:c}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:c}},[]).then(({Workbox:c})=>new c("/sudoku/sw.js",{scope:"/sudoku/",type:"classic"})).catch(c=>{i?.(c)}),!l)return;l.addEventListener("activated",c=>{(c.isUpdate||c.isExternal)&&window.location.reload()}),l.addEventListener("installed",c=>{c.isUpdate||o?.()}),l.register({immediate:t}).then(c=>{s?s("/sudoku/sw.js",c):n?.(c)}).catch(c=>{i?.(c)})}}return a=u(),f}const K=e=>{for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e},fe=(e,t)=>{if(e[t]!==0)return[];const r=Math.floor(t/9),o=t%9,n=new Set;for(let a=0;a<9;a++)n.add(e[r*9+a]),n.add(e[a*9+o]);const s=Math.floor(r/3)*3,i=Math.floor(o/3)*3;for(let a=s;a<s+3;a++)for(let f=i;f<i+3;f++)n.add(e[a*9+f]);const l=[];for(let a=1;a<=9;a++)n.has(a)||l.push(a);return l},xe=e=>{const t=e.slice(),r=()=>{let n=-1,s=null;for(let i=0;i<81;i++)if(t[i]===0){const l=fe(t,i);if(l.length===0)return{idx:i,cand:[]};if((!s||l.length<s.length)&&(s=l,n=i,l.length===1))break}return{idx:n,cand:s}},o=()=>{const{idx:n,cand:s}=r();if(n===-1)return!0;if(s.length===0)return!1;K(s);for(const i of s){if(t[n]=i,o())return!0;t[n]=0}return!1};return o()?t:null},Ce=(e,t=2)=>{const r=e.slice();let o=0;const n=()=>{let i=-1,l=null;for(let a=0;a<81;a++)if(r[a]===0){const f=fe(r,a);if(f.length===0)return{idx:a,cand:[]};if((!l||f.length<l.length)&&(l=f,i=a,f.length===1))break}return{idx:i,cand:l}},s=()=>{if(o>=t)return;const{idx:i,cand:l}=n();if(i===-1){o++;return}if(l.length!==0){for(const a of l)if(r[i]=a,s(),r[i]=0,o>=t)return}};return s(),o},Be=()=>xe(Array(81).fill(0)),oe=e=>e.map(t=>String(t)).join(""),Pe=({minClues:e=32,maxClues:t=36,symmetric:r=!0}={})=>{const o=Be();if(!o)throw new Error("Failed to generate solution");const n=o.slice(),s=Array.from({length:81},(u,c)=>c);K(s);const i=e+Math.floor(Math.random()*(t-e+1));let l=81;const a=new Set,f=[];for(const u of s){if(a.has(u))continue;if(!r){a.add(u),f.push([u]);continue}const c=80-u;a.add(u),a.add(c),f.push(u===c?[u]:[u,c])}K(f);for(const u of f){if(l<=i)break;const c=u.filter(d=>n[d]!==0).length;if(c===0||l-c<i)continue;const g=u.map(d=>n[d]);for(const d of u)n[d]=0;if(Ce(n,2)!==1)for(let d=0;d<u.length;d++)n[u[d]]=g[d];else l-=c}return{givens:oe(n),solution:oe(o)}},J="sudoku_v1",D=document.getElementById("board"),se=document.getElementById("pad"),Ie=document.getElementById("padContainer"),R=document.getElementById("boardWrap"),me=document.getElementById("newPuzzle"),pe=document.getElementById("resetPuzzle"),Me=document.getElementById("themeToggle"),_=document.getElementById("difficultyBubble"),L=document.getElementById("resetBubble"),Q=Array.from(document.querySelectorAll("[data-difficulty]")),ze=Array.from(document.querySelectorAll("[data-reset]")),U=document.getElementById("noteSwitch"),Oe=document.getElementById("eraseBtn"),j=document.getElementById("undoBtn"),W=document.getElementById("redoBtn"),ie=document.querySelectorAll("meta[name='theme-color']");let y=null,p=null,m=0,h=!1,H="light",G=null,$=null,b=[],E=[],x="easy";const A={cells:[],padButtons:new Map},Te=500,z={easy:{minClues:35,maxClues:40},medium:{minClues:30,maxClues:35},hard:{minClues:25,maxClues:30}},De=(e,t)=>e*9+t,ge=e=>[Math.floor(e/9),e%9],q=e=>1<<e-1,S=(e,t,r)=>Math.max(t,Math.min(r,e));function X(e){if(H=e==="dark"?"dark":"light",document.documentElement.setAttribute("data-theme",H),ie.length){const t=getComputedStyle(document.documentElement).getPropertyValue("--panel").trim();t&&ie.forEach(r=>r.setAttribute("content",t))}}function he(){return G?.matches?"dark":($?.matches,"light")}function le(){X(he())}function Re(){if(!window.matchMedia)return;G=window.matchMedia("(prefers-color-scheme: dark)"),$=window.matchMedia("(prefers-color-scheme: light)");const e=t=>{t&&(t.addEventListener?t.addEventListener("change",le):t.addListener&&t.addListener(le))};e(G),e($)}function F(e){const t=z[e]?e:"easy";x=t,Q.forEach(r=>{r.classList.toggle("menu__option--active",r.dataset.difficulty===t)})}function Ve(){const t=Q.find(o=>o.classList.contains("menu__option--active"))?.dataset.difficulty;return{...z[t]||z.easy,symmetric:Math.random()<.33}}function w(e){h=!!e,U.classList.toggle("pad__toggle--active",h),U.setAttribute("aria-checked",h?"true":"false"),Ie?.classList.toggle("pad--notes-mode",h),v()}function N(e){const t=!!e;_?.classList.toggle("menu__bubble--open",t),_?.setAttribute("aria-hidden",t?"false":"true"),me?.setAttribute("aria-expanded",t?"true":"false")}function k(e){const t=!!e;L?.classList.toggle("menu__bubble--open",t),L?.setAttribute("aria-hidden",t?"false":"true"),pe?.setAttribute("aria-expanded",t?"true":"false")}function Ke(e){return{entries:e.entries.map(String).join(""),notes:e.notes.slice()}}function C(){const e={puzzle:y,progress:Ke(p),history:b,redoHistory:E};localStorage.setItem(J,JSON.stringify(e))}function Ue(){const e=localStorage.getItem(J);if(!e)return!1;try{const t=JSON.parse(e);if(!t?.puzzle?.givens||!t?.puzzle?.solution||!t?.progress)return!1;const r=je(t.progress);return r?(y=t.puzzle,x=He(y.difficulty),p=r,b=Array.isArray(t.history)?t.history.map(ae).filter(Boolean):[],E=Array.isArray(t.redoHistory)?t.redoHistory.map(ae).filter(Boolean):[],!0):!1}catch{return!1}}function je(e){const t=We(e.entries),r=Array.isArray(e.notes)?e.notes.map(o=>Number(o)||0):null;return!t||!r||r.length!==81?null:{entries:t,notes:r}}function We(e){return e?Array.isArray(e)?e.length!==81?null:e.map(t=>S(Number(t)||0,0,9)):typeof e=="string"&&e.length===81?e.split("").map(t=>S(Number(t)||0,0,9)):null:null}function He(e){return z[e]?e:"easy"}function ae(e){if(!e||!Number.isInteger(e.idx)||e.idx<0||e.idx>=81)return null;const t=S(Number(e.prevEntry)||0,0,9),r=S(Number(e.nextEntry)||0,0,9),o=Number(e.prevNotes),n=Number(e.nextNotes);return!Number.isInteger(o)||!Number.isInteger(n)?null:{idx:e.idx,prevEntry:t,nextEntry:r,prevNotes:o,nextNotes:n}}function Ge(){D.innerHTML="",A.cells=[];for(let e=0;e<9;e++)for(let t=0;t<9;t++){const r=De(e,t),o=document.createElement("div");o.className="board__cell",o.dataset.idx=String(r),o.dataset.r=String(e),o.dataset.c=String(t);const n=document.createElement("div");n.className="board__value";const s=document.createElement("div");s.className="board__notes";for(let i=1;i<=9;i++){const l=document.createElement("div");l.className="board__note",l.dataset.n=String(i),l.textContent=String(i),s.appendChild(l)}o.appendChild(n),o.appendChild(s),D.appendChild(o),A.cells.push({idx:r,r:e,c:t,root:o,valueEl:n,noteEls:Array.from(s.querySelectorAll(".board__note"))})}se.innerHTML="",A.padButtons.clear();for(let e=1;e<=9;e++){const t=document.createElement("button");t.type="button",t.className="btn btn--pad pad__button",t.dataset.n=String(e),t.textContent=String(e),t.addEventListener("click",()=>ce(e)),se.appendChild(t),A.padButtons.set(e,t)}D.addEventListener("pointerdown",e=>{const t=e.target.closest(".board__cell");if(!t)return;const r=Number(t.dataset.idx);if(r===m){w(!h);return}ve(r)}),U.addEventListener("click",()=>w(!h)),Oe.addEventListener("click",()=>ue()),j.addEventListener("click",()=>de()),W?.addEventListener("click",()=>V()),me.addEventListener("click",e=>{e.stopPropagation(),k(!1);const t=_?.classList.contains("menu__bubble--open");N(!t)}),pe?.addEventListener("click",e=>{e.stopPropagation(),N(!1);const t=L?.classList.contains("menu__bubble--open");k(!t)}),Me?.addEventListener("click",()=>{X(H==="dark"?"light":"dark")}),Q.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const r=e.dataset.difficulty;F(r),localStorage.removeItem(J),Ee(),N(!1)})}),_?.addEventListener("click",e=>{e.stopPropagation()}),L?.addEventListener("click",e=>{e.stopPropagation()}),ze.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation(),k(!1),Ze()})}),window.addEventListener("keydown",e=>{if(["INPUT","TEXTAREA","SELECT"].includes(document.activeElement?.tagName))return;const t=e.key,r=navigator.userAgentData?navigator.userAgentData.platform==="macOS":/Mac|iPhone|iPad|iPod/.test(navigator.userAgent),o=t==="z"||t==="Z",n=t==="y"||t==="Y";if(o&&!e.altKey&&(r?e.metaKey:e.ctrlKey)){e.preventDefault(),e.shiftKey?V():de();return}if(n&&!e.altKey&&!e.shiftKey&&!r&&e.ctrlKey){e.preventDefault(),V();return}if(!(e.metaKey||e.ctrlKey||e.altKey)){if(t>="1"&&t<="9"){e.preventDefault(),ce(Number(t));return}if(t==="Backspace"||t==="Delete"){e.preventDefault(),ue();return}if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t)){e.preventDefault(),Qe(t);return}if(e.code==="Space"){e.preventDefault(),w(!h);return}}}),document.addEventListener("click",()=>{_?.classList.contains("menu__bubble--open")&&N(!1),L?.classList.contains("menu__bubble--open")&&k(!1)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&(_?.classList.contains("menu__bubble--open")&&N(!1),L?.classList.contains("menu__bubble--open")&&k(!1))})}function $e(e){return Number(y.givens[e])||p.entries[e]||0}function be(e){return Number(y.givens[e])!==0}function ye(){const e=Array(81).fill(0);for(let t=0;t<81;t++)e[t]=Number(y.givens[t])||p.entries[t]||0;return e}function qe(e){const t=Array.from({length:81},()=>!1);function r(o){const n=new Map;for(const s of o){const i=e[s];i&&(n.has(i)||n.set(i,[]),n.get(i).push(s))}for(const s of n.values())if(s.length>=2)for(const i of s)t[i]=!0}for(let o=0;o<9;o++)r(Array.from({length:9},(n,s)=>o*9+s));for(let o=0;o<9;o++)r(Array.from({length:9},(n,s)=>s*9+o));for(let o=0;o<3;o++)for(let n=0;n<3;n++){const s=[];for(let i=o*3;i<o*3+3;i++)for(let l=n*3;l<n*3+3;l++)s.push(i*9+l);r(s)}return t}function Fe(e){const t=Array.from({length:9},()=>new Set),r=Array.from({length:9},()=>new Set),o=Array.from({length:9},()=>new Set);for(let n=0;n<81;n++){const s=e[n];if(!s)continue;const[i,l]=ge(n);t[i].add(s),r[l].add(s);const a=Math.floor(i/3)*3+Math.floor(l/3);o[a].add(s)}return{rowValues:t,colValues:r,boxValues:o}}function Ye(){for(let e=0;e<81;e++){const t=Number(y.givens[e])||p.entries[e]||0;if(t===0||t!==Number(y.solution[e]))return!1}return!0}function Je(e){const t=ye();let r=0;for(const o of t)o===e&&(r+=1);return r>=9}function v(){const e=y.givens,t=p.entries,r=p.notes,o=$e(m),n=ye(),s=Array(10).fill(0);n.forEach(u=>{u&&(s[u]+=1)});const i=qe(n),{rowValues:l,colValues:a,boxValues:f}=Fe(n);if(R?.classList.toggle("board-shell--completed",Ye()),R){const u=`COMPLETED â€¢ ${x.toUpperCase()}`;R.setAttribute("data-completed-label",u)}A.cells.forEach(u=>{const{idx:c,root:g,valueEl:d,noteEls:B,r:O,c:_e}=u;g.classList.remove("board__cell--selected","board__cell--highlight","board__cell--error","board__cell--has-value","board__cell--notes-active"),d.classList.remove("board__value--given","board__value--entry"),d.textContent="",B.forEach(I=>{I.classList.remove("board__note--filled","board__note--conflict")});const ee=Number(e[c]),Le=t[c],P=ee||Le||0;if(P)g.classList.add("board__cell--has-value"),d.textContent=String(P),d.classList.add(ee?"board__value--given":"board__value--entry");else{const I=r[c]|0;if(I){const te=O,ne=_e,Ae=Math.floor(te/3)*3+Math.floor(ne/3);B.forEach(T=>{const M=Number(T.dataset.n);I&q(M)&&(T.classList.add("board__note--filled"),(l[te].has(M)||a[ne].has(M)||f[Ae].has(M))&&T.classList.add("board__note--conflict"))})}}!P&&h&&c===m&&g.classList.add("board__cell--notes-active"),c===m&&g.classList.add("board__cell--selected"),o!==0&&P===o&&g.classList.add("board__cell--highlight"),i[c]&&g.classList.add("board__cell--error")}),A.padButtons.forEach((u,c)=>{const g=s[c]>=9;u.disabled=!h&&g}),Xe()}function ve(e){m=S(e,0,80),v()}function Qe(e){const[t,r]=ge(m);let o=t,n=r;e==="ArrowUp"&&(o=(t+8)%9),e==="ArrowDown"&&(o=(t+1)%9),e==="ArrowLeft"&&(n=(r+8)%9),e==="ArrowRight"&&(n=(r+1)%9),m=o*9+n,v()}function ce(e){if(be(m)||!h&&Je(e))return;const t=p.notes[m]|0;if(h){const s=p.entries[m]!==0?t|q(e):t^q(e);Y(m,0,s);return}Y(m,e,t)}function ue(){if(be(m))return;const t=p.entries[m]!==0?p.notes[m]|0:0;Y(m,0,t)}function Y(e,t,r){const o=p.entries[e],n=p.notes[e]|0;o===t&&n===r||(Z(e,t,r),b.push({idx:e,prevEntry:o,prevNotes:n,nextEntry:t,nextNotes:r}),E=[],b.length>Te&&b.shift(),C(),v())}function Z(e,t,r){p.entries[e]=t,p.notes[e]=r}function de(){const e=b.pop();e&&(Z(e.idx,e.prevEntry,e.prevNotes),E.push(e),C(),v())}function V(){const e=E.pop();e&&(Z(e.idx,e.nextEntry,e.nextNotes),b.push(e),C(),v())}function Xe(){j&&(j.disabled=b.length===0),W&&(W.disabled=E.length===0)}function Ee(){y={...Pe(Ve()),difficulty:x},p={entries:Array(81).fill(0),notes:Array(81).fill(0)},m=0,b=[],E=[],w(!1),C(),v()}function Ze(){p={entries:Array(81).fill(0),notes:Array(81).fill(0)},b=[],E=[],m=0,w(!1),C(),v()}function et(){Se({immediate:!0}),Re(),X(he()),Ge(),F("easy"),Ue()?(F(x),w(!1),v()):Ee(),ve(0)}et();

(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const u of r)if(u.type==="childList")for(const m of u.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function n(r){const u={};return r.integrity&&(u.integrity=r.integrity),r.referrerPolicy&&(u.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?u.credentials="include":r.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(r){if(r.ep)return;r.ep=!0;const u=n(r);fetch(r.href,u)}})();const Re="modulepreload",De=function(e){return"/sudoku/"+e},ke={},Ve=function(t,n,o){let r=Promise.resolve();if(n&&n.length>0){let f=function(s){return Promise.all(s.map(i=>Promise.resolve(i).then(c=>({status:"fulfilled",value:c}),c=>({status:"rejected",reason:c}))))};var m=f;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),l=d?.nonce||d?.getAttribute("nonce");r=f(n.map(s=>{if(s=De(s),s in ke)return;ke[s]=!0;const i=s.endsWith(".css"),c=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${c}`))return;const a=document.createElement("link");if(a.rel=i?"stylesheet":Re,i||(a.as="script"),a.crossOrigin="",a.href=s,l&&a.setAttribute("nonce",l),document.head.appendChild(a),i)return new Promise((p,g)=>{a.addEventListener("load",p),a.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${s}`)))})}))}function u(d){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=d,window.dispatchEvent(l),!l.defaultPrevented)throw d}return r.then(d=>{for(const l of d||[])l.status==="rejected"&&u(l.reason);return t().catch(u)})};function Ke(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:r,onRegisteredSW:u,onRegisterError:m}=e;let d,l;const f=async(i=!0)=>{await l};async function s(){if("serviceWorker"in navigator){if(d=await Ve(async()=>{const{Workbox:i}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:i}},[]).then(({Workbox:i})=>new i("/sudoku/sw.js",{scope:"/sudoku/",type:"classic"})).catch(i=>{m?.(i)}),!d)return;d.addEventListener("activated",i=>{(i.isUpdate||i.isExternal)&&window.location.reload()}),d.addEventListener("installed",i=>{i.isUpdate||o?.()}),d.register({immediate:t}).then(i=>{u?u("/sudoku/sw.js",i):r?.(i)}).catch(i=>{m?.(i)})}}return l=s(),f}const oe=e=>{for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},Ne=511,w=e=>1<<e-1,Ue=e=>e!==0&&(e&e-1)===0,je=e=>Math.log2(e)+1,j=e=>{let t=0,n=e;for(;n;)n&=n-1,t+=1;return t},M=[];for(let e=0;e<9;e++){const t=[],n=[];for(let o=0;o<9;o++)t.push(e*9+o),n.push(o*9+e);M.push(t,n)}for(let e=0;e<3;e++)for(let t=0;t<3;t++){const n=[];for(let o=0;o<3;o++)for(let r=0;r<3;r++)n.push((e*3+o)*9+t*3+r);M.push(n)}const X=Array.from({length:81},()=>new Set);for(const e of M)for(const t of e)for(const n of e)t!==n&&X[t].add(n);const fe=(e,t)=>{if(e[t]!==0)return 0;let n=0;for(const o of X[t]){const r=e[o];r&&(n|=w(r))}return Ne&~n},de=e=>{const t=[];for(let n=1;n<=9;n++)e&w(n)&&t.push(n);return t},He=e=>{const t=e.slice(),n=()=>{let r=-1,u=null;for(let m=0;m<81;m++)if(t[m]===0){const d=fe(t,m),l=j(d);if(l===0)return{idx:m,cand:[]};if((!u||l<u.count)&&(u={mask:d,count:l},r=m,l===1))break}return{idx:r,cand:u}},o=()=>{const{idx:r,cand:u}=n();if(r===-1)return!0;if(!u||u.count===0)return!1;const m=oe(de(u.mask));for(const d of m){if(t[r]=d,o())return!0;t[r]=0}return!1};return o()?t:null},We=(e,t=2)=>{const n=e.slice();let o=0;const r=()=>{let m=-1,d=null;for(let l=0;l<81;l++)if(n[l]===0){const f=fe(n,l),s=j(f);if(s===0)return{idx:l,cand:[]};if((!d||s<d.count)&&(d={mask:f,count:s},m=l,s===1))break}return{idx:m,cand:d}},u=()=>{if(o>=t)return;const{idx:m,cand:d}=r();if(m===-1){o++;return}if(!d||d.count===0)return;const l=de(d.mask);for(const f of l)if(n[m]=f,u(),n[m]=0,o>=t)return};return u(),o},Fe=e=>{const t=e.slice();let n=0,o=0,r=0;const u=()=>{let l=-1,f=null;for(let s=0;s<81;s++)if(t[s]===0){const i=fe(t,s),c=j(i);if(c===0)return{idx:s,cand:[]};if((!f||c<f.count)&&(f={mask:i,count:c},l=s,c===1))break}return{idx:l,cand:f}},m=l=>{n+=1,l>r&&(r=l);const{idx:f,cand:s}=u();if(f===-1)return!0;if(!s||s.count===0)return!1;const i=de(s.mask);i.length>1&&(o+=1);for(const c of i){if(t[f]=c,m(l+1))return!0;t[f]=0}return!1};return{solved:m(0),nodes:n,guesses:o,maxDepth:r}},Ee=()=>He(Array(81).fill(0)),B=e=>e.map(t=>String(t)).join(""),Ge=e=>{const t=Array(81).fill(0);for(let n=0;n<81;n++){if(e[n]!==0)continue;let o=0;for(const u of X[n]){const m=e[u];m&&(o|=w(m))}const r=Ne&~o;t[n]=r}return t},$e=e=>{const t=e.slice(),n=Ge(t),o={nakedSingles:0,hiddenSingles:0,lockedElims:0,nakedPairs:0,hiddenPairs:0,nakedTriples:0,hiddenTriples:0},r=(d,l)=>{t[d]=l,n[d]=0;for(const f of X[d])t[f]===0&&(n[f]&=~w(l))};for(;;){let d=!1;for(let f=0;f<81;f++){if(t[f]!==0)continue;const s=n[f];if(s===0)return{solved:!1,score:1/0,stats:o};Ue(s)&&(r(f,je(s)),o.nakedSingles+=1,d=!0)}if(d)continue;for(const f of M){for(let s=1;s<=9;s++){const i=w(s);let c=0,a=-1;for(const p of f)if(t[p]===0&&n[p]&i&&(c+=1,a=p,c>1))break;if(c===1){r(a,s),o.hiddenSingles+=1,d=!0;break}}if(d)break}if(d)continue;let l=!1;for(let f=0;f<9;f++){const s=Math.floor(f/3)*3,i=f%3*3,c=[];for(let a=0;a<3;a++)for(let p=0;p<3;p++)c.push((s+a)*9+i+p);for(let a=1;a<=9;a++){const p=w(a),g=c.filter(b=>t[b]===0&&n[b]&p);if(g.length<2)continue;const h=new Set(g.map(b=>Math.floor(b/9)));if(h.size===1){const b=h.values().next().value;for(const v of M[b])!c.includes(v)&&t[v]===0&&n[v]&p&&(n[v]&=~p,l=!0)}const _=new Set(g.map(b=>b%9));if(_.size===1){const b=_.values().next().value;for(const v of M[9+b])!c.includes(v)&&t[v]===0&&n[v]&p&&(n[v]&=~p,l=!0)}}}for(let f=0;f<9;f++){const s=M[f];for(let i=1;i<=9;i++){const c=w(i),a=s.filter(g=>t[g]===0&&n[g]&c);if(a.length<2)continue;const p=new Set(a.map(g=>Math.floor(g/27)*3+Math.floor(g%9/3)));if(p.size===1){const g=p.values().next().value,h=Math.floor(g/3)*3,_=g%3*3;for(let b=0;b<3;b++)for(let v=0;v<3;v++){const L=(h+b)*9+_+v;!s.includes(L)&&t[L]===0&&n[L]&c&&(n[L]&=~c,l=!0)}}}}for(let f=0;f<9;f++){const s=M[9+f];for(let i=1;i<=9;i++){const c=w(i),a=s.filter(g=>t[g]===0&&n[g]&c);if(a.length<2)continue;const p=new Set(a.map(g=>Math.floor(g/27)*3+Math.floor(g%9/3)));if(p.size===1){const g=p.values().next().value,h=Math.floor(g/3)*3,_=g%3*3;for(let b=0;b<3;b++)for(let v=0;v<3;v++){const L=(h+b)*9+_+v;!s.includes(L)&&t[L]===0&&n[L]&c&&(n[L]&=~c,l=!0)}}}}if(l){o.lockedElims+=1;continue}l=!1;for(const f of M){const s=new Map;for(const i of f){if(t[i]!==0)continue;const c=n[i];if(c===0)return{solved:!1,score:1/0,stats:o};if(j(c)===2){const a=s.get(c)||[];a.push(i),s.set(c,a)}}for(const[i,c]of s.entries())if(c.length===2)for(const a of f)t[a]!==0||c.includes(a)||n[a]&i&&(n[a]&=~i,l=!0)}if(l){o.nakedPairs+=1;continue}l=!1;for(const f of M){const s=Array.from({length:10},()=>[]);for(const i of f){if(t[i]!==0)continue;const c=n[i];for(let a=1;a<=9;a++)c&w(a)&&s[a].push(i)}for(let i=1;i<=8;i++)if(s[i].length===2)for(let c=i+1;c<=9;c++){if(s[c].length!==2)continue;const a=s[i],p=s[c];if(a[0]!==p[0]||a[1]!==p[1])continue;const g=w(i)|w(c);for(const h of a){const _=n[h]&g;_!==n[h]&&(n[h]=_,l=!0)}}}if(l){o.hiddenPairs+=1;continue}l=!1;for(const f of M){const s=[];for(const i of f){if(t[i]!==0)continue;const c=n[i],a=j(c);a>=2&&a<=3&&s.push({idx:i,mask:c})}for(let i=0;i<s.length-2;i++)for(let c=i+1;c<s.length-1;c++)for(let a=c+1;a<s.length;a++){const p=s[i].mask|s[c].mask|s[a].mask;if(j(p)===3)for(const g of f)t[g]===0&&(g===s[i].idx||g===s[c].idx||g===s[a].idx||n[g]&p&&(n[g]&=~p,l=!0))}}if(l){o.nakedTriples+=1;continue}l=!1;for(const f of M){const s=Array.from({length:10},()=>[]);for(const i of f){if(t[i]!==0)continue;const c=n[i];for(let a=1;a<=9;a++)c&w(a)&&s[a].push(i)}for(let i=1;i<=7;i++)if(s[i].length!==0){for(let c=i+1;c<=8;c++)if(s[c].length!==0)for(let a=c+1;a<=9;a++){if(s[a].length===0)continue;const p=new Set([...s[i],...s[c],...s[a]]);if(p.size!==3)continue;const g=w(i)|w(c)|w(a);for(const h of p){if(t[h]!==0)continue;const _=n[h]&g;_!==n[h]&&(n[h]=_,l=!0)}}}}if(l){o.hiddenTriples+=1;continue}break}const u=t.every(d=>d!==0),m=o.nakedSingles*1+o.hiddenSingles*2+o.lockedElims*2+o.nakedPairs*6+o.hiddenPairs*7+o.nakedTriples*8+o.hiddenTriples*9;return{solved:u,score:m,stats:o}},qe=({scoreMin:e=0,scoreMax:t=1/0,searchMin:n=0,searchMax:o=1/0,ratingMode:r="human",symmetric:u=!0,maxAttempts:m=50}={})=>{const d=r==="tiered";let l=null,f=null,s=null,i=null;const c=Number.isFinite(m);for(let p=0;p<m;p++){const g=Ee();if(!g)throw new Error("Failed to generate solution");const h=g.slice(),_=Array.from({length:81},(y,A)=>A);oe(_);let b=81;const v=new Set,L=[];for(const y of _){if(v.has(y))continue;if(!u){v.add(y),L.push([y]);continue}const A=80-y;v.add(y),v.add(A),L.push(y===A?[y]:[y,A])}oe(L);for(const y of L){const A=y.filter(k=>h[k]!==0).length;if(A===0)continue;const q=y.map(k=>h[k]);for(const k of y)h[k]=0;if(We(h,2)!==1){for(let k=0;k<y.length;k++)h[y[k]]=q[k];continue}b-=A;const S=$e(h);if(S.solved){if(S.score>=e&&S.score<=t&&(!l||S.score>l.score||S.score===l.score&&b<l.clues)&&(l={score:S.score,clues:b,givens:B(h),solution:B(g)},!c&&!d))return{givens:l.givens,solution:l.solution};const k=S.score<e?e-S.score:S.score-t;(!f||k<f.diff)&&(f={diff:k,givens:B(h),solution:B(g)})}else if(d){const k=Fe(h);if(!k.solved)continue;const C=k.nodes;C>=n&&C<=o&&(!s||C>s.score||C===s.score&&b<s.clues)&&(s={score:C,clues:b,givens:B(h),solution:B(g)});const R=C<n?n-C:C-o;(!i||R<i.diff)&&(i={diff:R,givens:B(h),solution:B(g)})}}}if(d){if(s)return{givens:s.givens,solution:s.solution};if(l)return{givens:l.givens,solution:l.solution};if(i)return{givens:i.givens,solution:i.solution};if(f)return{givens:f.givens,solution:f.solution}}if(l)return{givens:l.givens,solution:l.solution};if(f)return{givens:f.givens,solution:f.solution};const a=Ee();return{givens:B(a),solution:B(a)}},me="sudoku_v1",ee=document.getElementById("board"),_e=document.getElementById("pad"),Ye=document.getElementById("padContainer"),te=document.getElementById("boardWrap"),ge=document.getElementById("newPuzzle"),pe=document.getElementById("resetPuzzle"),Be=document.getElementById("themeToggle"),V=document.getElementById("difficultyBubble"),K=document.getElementById("resetBubble"),Je=document.getElementById("loadingOverlay"),Z=Array.from(document.querySelectorAll("[data-difficulty]")),Qe=Array.from(document.querySelectorAll("[data-reset]")),Y=document.getElementById("noteSwitch"),he=document.getElementById("autoCandidatesToggle"),Xe=document.getElementById("eraseBtn"),se=document.getElementById("undoBtn"),re=document.getElementById("redoBtn"),xe=document.querySelectorAll("meta[name='theme-color']");let I=null,x=null,E=0,N=!1,z=!1,ie="light",le=null,ce=null,P=[],O=[],G="easy";const U={cells:[],padButtons:new Map},Ze=500,J={easy:{scoreMin:40,scoreMax:50,maxAttempts:10,ratingMode:"human"},medium:{scoreMin:65,scoreMax:75,maxAttempts:10,ratingMode:"human"},hard:{scoreMin:100,scoreMax:250,searchMin:2e3,searchMax:6e3,maxAttempts:100,ratingMode:"tiered"}},et=(e,t)=>e*9+t,be=e=>[Math.floor(e/9),e%9],Q=e=>1<<e-1,F=(e,t,n)=>Math.max(t,Math.min(n,e));function ve(e){if(ie=e==="dark"?"dark":"light",document.documentElement.setAttribute("data-theme",ie),xe.length){const t=getComputedStyle(document.documentElement).getPropertyValue("--panel").trim();t&&xe.forEach(n=>n.setAttribute("content",t))}}function Pe(){return le?.matches?"dark":(ce?.matches,"light")}function Le(){ve(Pe())}function tt(){if(!window.matchMedia)return;le=window.matchMedia("(prefers-color-scheme: dark)"),ce=window.matchMedia("(prefers-color-scheme: light)");const e=t=>{t&&(t.addEventListener?t.addEventListener("change",Le):t.addListener&&t.addListener(Le))};e(le),e(ce)}function ae(e){const t=J[e]?e:"easy";G=t,Z.forEach(n=>{n.classList.toggle("menu__option--active",n.dataset.difficulty===t)})}function nt(){const t=Z.find(o=>o.classList.contains("menu__option--active"))?.dataset.difficulty;return{...J[t]||J.easy,symmetric:Math.random()<.33}}function D(e){z&&e||(N=!!e,Y.classList.toggle("pad__toggle--active",N),Y.setAttribute("aria-checked",N?"true":"false"),Ye?.classList.toggle("pad--notes-mode",N),T())}function ot(e){z=!!e,he.checked=z,Y.disabled=z,z&&D(!1),T()}function H(e){const t=!!e;V?.classList.toggle("menu__bubble--open",t),V?.setAttribute("aria-hidden",t?"false":"true"),ge?.setAttribute("aria-expanded",t?"true":"false")}function W(e){const t=!!e;K?.classList.toggle("menu__bubble--open",t),K?.setAttribute("aria-hidden",t?"false":"true"),pe?.setAttribute("aria-expanded",t?"true":"false")}function we(e){const t=!!e;document.body.classList.toggle("app--loading",t),Je?.setAttribute("aria-hidden",t?"false":"true"),ge.disabled=t,pe.disabled=t,Be.disabled=t,he.disabled=t,Z.forEach(n=>{n.disabled=t})}function st(){return new Promise(e=>{requestAnimationFrame(()=>setTimeout(e,0))})}function rt(e){return{entries:e.entries.map(String).join(""),notes:e.notes.slice()}}function $(){const e={puzzle:I,progress:rt(x),history:P,redoHistory:O};localStorage.setItem(me,JSON.stringify(e))}function it(){const e=localStorage.getItem(me);if(!e)return!1;try{const t=JSON.parse(e);if(!t?.puzzle?.givens||!t?.puzzle?.solution||!t?.progress)return!1;const n=lt(t.progress);return n?(I=t.puzzle,G=at(I.difficulty),x=n,P=Array.isArray(t.history)?t.history.map(Ae).filter(Boolean):[],O=Array.isArray(t.redoHistory)?t.redoHistory.map(Ae).filter(Boolean):[],!0):!1}catch{return!1}}function lt(e){const t=ct(e.entries),n=Array.isArray(e.notes)?e.notes.map(o=>Number(o)||0):null;return!t||!n||n.length!==81?null:{entries:t,notes:n}}function ct(e){return e?Array.isArray(e)?e.length!==81?null:e.map(t=>F(Number(t)||0,0,9)):typeof e=="string"&&e.length===81?e.split("").map(t=>F(Number(t)||0,0,9)):null:null}function at(e){return J[e]?e:"easy"}function Ae(e){if(!e||!Number.isInteger(e.idx)||e.idx<0||e.idx>=81)return null;const t=F(Number(e.prevEntry)||0,0,9),n=F(Number(e.nextEntry)||0,0,9),o=Number(e.prevNotes),r=Number(e.nextNotes);return!Number.isInteger(o)||!Number.isInteger(r)?null:{idx:e.idx,prevEntry:t,nextEntry:n,prevNotes:o,nextNotes:r}}function ut(){ee.innerHTML="",U.cells=[];for(let e=0;e<9;e++)for(let t=0;t<9;t++){const n=et(e,t),o=document.createElement("div");o.className="board__cell",o.dataset.idx=String(n),o.dataset.r=String(e),o.dataset.c=String(t);const r=document.createElement("div");r.className="board__value";const u=document.createElement("div");u.className="board__notes";for(let m=1;m<=9;m++){const d=document.createElement("div");d.className="board__note",d.dataset.n=String(m),d.textContent=String(m),u.appendChild(d)}o.appendChild(r),o.appendChild(u),ee.appendChild(o),U.cells.push({idx:n,r:e,c:t,root:o,valueEl:r,noteEls:Array.from(u.querySelectorAll(".board__note"))})}_e.innerHTML="",U.padButtons.clear();for(let e=1;e<=9;e++){const t=document.createElement("button");t.type="button",t.className="btn btn--pad pad__button",t.dataset.n=String(e),t.textContent=String(e),t.addEventListener("click",()=>Se(e)),_e.appendChild(t),U.padButtons.set(e,t)}ee.addEventListener("pointerdown",e=>{const t=e.target.closest(".board__cell");if(!t)return;const n=Number(t.dataset.idx);if(n===E){z||D(!N);return}ze(n)}),Y.addEventListener("click",()=>D(!N)),he.addEventListener("change",e=>{ot(e.target.checked)}),Xe.addEventListener("click",()=>Ce()),se.addEventListener("click",()=>Me()),re?.addEventListener("click",()=>ne()),ge.addEventListener("click",e=>{e.stopPropagation(),W(!1);const t=V?.classList.contains("menu__bubble--open");H(!t)}),pe?.addEventListener("click",e=>{e.stopPropagation(),H(!1);const t=K?.classList.contains("menu__bubble--open");W(!t)}),Be?.addEventListener("click",()=>{ve(ie==="dark"?"light":"dark")}),Z.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const n=e.dataset.difficulty;ae(n),localStorage.removeItem(me),Oe(),H(!1)})}),V?.addEventListener("click",e=>{e.stopPropagation()}),K?.addEventListener("click",e=>{e.stopPropagation()}),Qe.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation(),W(!1),yt()})}),window.addEventListener("keydown",e=>{if(["INPUT","TEXTAREA","SELECT"].includes(document.activeElement?.tagName))return;const t=e.key,n=navigator.userAgentData?navigator.userAgentData.platform==="macOS":/Mac|iPhone|iPad|iPod/.test(navigator.userAgent),o=t==="z"||t==="Z",r=t==="y"||t==="Y";if(o&&!e.altKey&&(n?e.metaKey:e.ctrlKey)){e.preventDefault(),e.shiftKey?ne():Me();return}if(r&&!e.altKey&&!e.shiftKey&&!n&&e.ctrlKey){e.preventDefault(),ne();return}if(!(e.metaKey||e.ctrlKey||e.altKey)){if(t>="1"&&t<="9"){e.preventDefault(),Se(Number(t));return}if(t==="Backspace"||t==="Delete"){e.preventDefault(),Ce();return}if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t)){e.preventDefault(),bt(t);return}if(e.code==="Space"&&!z){e.preventDefault(),D(!N);return}}}),document.addEventListener("click",()=>{V?.classList.contains("menu__bubble--open")&&H(!1),K?.classList.contains("menu__bubble--open")&&W(!1)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&(V?.classList.contains("menu__bubble--open")&&H(!1),K?.classList.contains("menu__bubble--open")&&W(!1))})}function ft(e){return Number(I.givens[e])||x.entries[e]||0}function Ie(e){return Number(I.givens[e])!==0}function Te(){const e=Array(81).fill(0);for(let t=0;t<81;t++)e[t]=Number(I.givens[t])||x.entries[t]||0;return e}function dt(e){const t=Array.from({length:81},()=>!1);function n(o){const r=new Map;for(const u of o){const m=e[u];m&&(r.has(m)||r.set(m,[]),r.get(m).push(u))}for(const u of r.values())if(u.length>=2)for(const m of u)t[m]=!0}for(let o=0;o<9;o++)n(Array.from({length:9},(r,u)=>o*9+u));for(let o=0;o<9;o++)n(Array.from({length:9},(r,u)=>u*9+o));for(let o=0;o<3;o++)for(let r=0;r<3;r++){const u=[];for(let m=o*3;m<o*3+3;m++)for(let d=r*3;d<r*3+3;d++)u.push(m*9+d);n(u)}return t}function mt(e){const t=Array.from({length:9},()=>new Set),n=Array.from({length:9},()=>new Set),o=Array.from({length:9},()=>new Set);for(let r=0;r<81;r++){const u=e[r];if(!u)continue;const[m,d]=be(r);t[m].add(u),n[d].add(u);const l=Math.floor(m/3)*3+Math.floor(d/3);o[l].add(u)}return{rowValues:t,colValues:n,boxValues:o}}function gt(e,t,n,o){const r=Array(81).fill(0);for(let u=0;u<81;u++){if(e[u])continue;const[m,d]=be(u),l=Math.floor(m/3)*3+Math.floor(d/3);let f=0;for(let s=1;s<=9;s++)!t[m].has(s)&&!n[d].has(s)&&!o[l].has(s)&&(f|=Q(s));r[u]=f}return r}function pt(){for(let e=0;e<81;e++){const t=Number(I.givens[e])||x.entries[e]||0;if(t===0||t!==Number(I.solution[e]))return!1}return!0}function ht(e){const t=Te();let n=0;for(const o of t)o===e&&(n+=1);return n>=9}function T(){const e=I.givens,t=x.entries,n=x.notes,o=ft(E),r=Te(),u=Array(10).fill(0);r.forEach(c=>{c&&(u[c]+=1)});const m=dt(r),{rowValues:d,colValues:l,boxValues:f}=mt(r),s=z?gt(r,d,l,f):null,i=z?s:n;if(te?.classList.toggle("board-shell--completed",pt()),te){const c=`COMPLETED â€¢ ${G.toUpperCase()}`;te.setAttribute("data-completed-label",c)}U.cells.forEach(c=>{const{idx:a,root:p,valueEl:g,noteEls:h,r:_,c:b}=c;p.classList.remove("board__cell--selected","board__cell--highlight","board__cell--error","board__cell--has-value","board__cell--notes-active"),g.classList.remove("board__value--given","board__value--entry"),g.textContent="",h.forEach(A=>{A.classList.remove("board__note--filled","board__note--conflict")});const v=Number(e[a]),L=t[a],y=v||L||0;if(y)p.classList.add("board__cell--has-value"),g.textContent=String(y),g.classList.add(v?"board__value--given":"board__value--entry");else{const A=i[a]|0;if(A){const q=_,S=b,k=Math.floor(q/3)*3+Math.floor(S/3);h.forEach(C=>{const R=Number(C.dataset.n);A&Q(R)&&(C.classList.add("board__note--filled"),(d[q].has(R)||l[S].has(R)||f[k].has(R))&&C.classList.add("board__note--conflict"))})}}!y&&N&&a===E&&p.classList.add("board__cell--notes-active"),a===E&&p.classList.add("board__cell--selected"),o!==0&&y===o&&p.classList.add("board__cell--highlight"),m[a]&&p.classList.add("board__cell--error")}),U.padButtons.forEach((c,a)=>{const p=u[a]>=9;c.disabled=!N&&p}),vt()}function ze(e){E=F(e,0,80),T()}function bt(e){const[t,n]=be(E);let o=t,r=n;e==="ArrowUp"&&(o=(t+8)%9),e==="ArrowDown"&&(o=(t+1)%9),e==="ArrowLeft"&&(r=(n+8)%9),e==="ArrowRight"&&(r=(n+1)%9),E=o*9+r,T()}function Se(e){if(Ie(E)||!N&&ht(e))return;const t=x.notes[E]|0;if(N){const u=x.entries[E]!==0?t|Q(e):t^Q(e);ue(E,0,u);return}ue(E,e,t)}function Ce(){if(Ie(E))return;const t=x.entries[E]!==0?x.notes[E]|0:0;ue(E,0,t)}function ue(e,t,n){const o=x.entries[e],r=x.notes[e]|0;o===t&&r===n||(ye(e,t,n),P.push({idx:e,prevEntry:o,prevNotes:r,nextEntry:t,nextNotes:n}),O=[],P.length>Ze&&P.shift(),$(),T())}function ye(e,t,n){x.entries[e]=t,x.notes[e]=n}function Me(){const e=P.pop();e&&(ye(e.idx,e.prevEntry,e.prevNotes),O.push(e),$(),T())}function ne(){const e=O.pop();e&&(ye(e.idx,e.nextEntry,e.nextNotes),P.push(e),$(),T())}function vt(){se&&(se.disabled=P.length===0),re&&(re.disabled=O.length===0)}async function Oe(){we(!0),await st();try{I={...qe(nt()),difficulty:G},x={entries:Array(81).fill(0),notes:Array(81).fill(0)},E=0,P=[],O=[],D(!1),$(),T()}finally{we(!1)}}function yt(){x={entries:Array(81).fill(0),notes:Array(81).fill(0)},P=[],O=[],E=0,D(!1),$(),T()}function kt(){Ke({immediate:!0}),tt(),ve(Pe()),ut(),ae("easy"),it()?(ae(G),D(!1),T()):Oe(),ze(0)}kt();
